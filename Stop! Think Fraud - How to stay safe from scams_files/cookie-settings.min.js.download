(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/* globals jQuery, cookieOptions, googleAnalytics, globalGoogleAnalytics, ga4Analytics, googleFloodlight, facebookPixel, linkedinInsight, googleTagManager, globalGoogleTagManager */
'use strict'

const CookieMonster = require('@firstandthird/cookie-monster').FirstandthirdCookieMonster

const saveCookieSettings = function () {
  const analyticsOption = jQuery('input[name="analytics"]:checked').val()
  const marketingOption = jQuery('input[name="marketing"]:checked').val()
  if (analyticsOption === 'off') {
    deactivateAnalyticsScripts()
  }
  if (marketingOption === 'off') {
    deactivateMarketingScripts()
  }
  CookieMonster.set('cookies-analytics-option', analyticsOption, 365)
  CookieMonster.set('cookies-marketing-option', marketingOption, 365)
}

const getCurrentCookieOption = function (cookieType) {
  if (CookieMonster.get('cookies-' + cookieType + '-option')) {
    return CookieMonster.get('cookies-' + cookieType + '-option')
  } else {
    return 'off'
  }
}

const activateAnalyticsScripts = function () {
  if (typeof googleAnalytics === 'object') {
    googleAnalytics.on()
  }
  if (typeof ga4Analytics === 'object') {
    ga4Analytics.on()
  }
  if (typeof globalGoogleAnalytics === 'object') {
    globalGoogleAnalytics.on()
  }
  if (typeof globalGoogleTagManager === 'object') {
    globalGoogleTagManager.on()
  }
}

const deactivateAnalyticsScripts = function () {
  if (typeof googleAnalytics === 'object') {
    googleAnalytics.off()
    googleAnalytics.firstPartyCookies.forEach(function (cookie) {
      document.cookie = cookie + '=; path=/; domain=' + cookieOptions.cookieDomain + '; expires=Thu, 01 Jan 1970 00:00:01 GMT;'
    })
  }
  if (typeof ga4Analytics === 'object') {
    ga4Analytics.off()
    ga4Analytics.firstPartyCookies.forEach(function (cookie) {
      document.cookie = cookie + '=; path=/; domain=' + cookieOptions.cookieDomain + '; expires=Thu, 01 Jan 1970 00:00:01 GMT;'
    })
  }
  if (typeof globalGoogleAnalytics === 'object') {
    globalGoogleAnalytics.off()
    globalGoogleAnalytics.firstPartyCookies.forEach(function (cookie) {
      document.cookie = cookie + '=; path=/; domain=' + cookieOptions.cookieDomain + '; expires=Thu, 01 Jan 1970 00:00:01 GMT;'
    })
  }
}

const activateMarketingScripts = function () {
  if (typeof googleFloodlight === 'object') {
    googleFloodlight.on()
  }
  if (typeof facebookPixel === 'object') {
    facebookPixel.on()
  }
  if (typeof linkedinInsight === 'object') {
    linkedinInsight.on()
  }
  if (typeof googleTagManager === 'object') {
    googleTagManager.on()
  }
}

const deactivateMarketingScripts = function () {
  if (typeof googleFloodlight === 'object') {
    googleFloodlight.off()
  }
  if (typeof facebookPixel === 'object') {
    facebookPixel.off()
    facebookPixel.firstPartyCookies.forEach(function (cookie) {
      document.cookie = cookie + '=; path=/; domain=' + cookieOptions.cookieDomain + '; expires=Thu, 01 Jan 1970 00:00:01 GMT;'
    })
  }
}

const activateAllTrackingScripts = function () {
  activateAnalyticsScripts()
  activateMarketingScripts()
}

const activateApprovedTrackingScripts = function () {
  if (cookieOptions.useGovukCookieSettings === '1') {
    if (getCurrentCookieOption('analytics') === 'on') {
      activateAnalyticsScripts()
    }
    if (getCurrentCookieOption('marketing') === 'on') {
      activateMarketingScripts()
    }
  } else {
    activateAllTrackingScripts()
  }
}

const setupCookieSettingsForm = function ($) {
  if ($('#cookie-settings-panel').length) {
    $('#cookie-settings-panel').removeClass('display-none')
    $('input[name="analytics"][value="' + getCurrentCookieOption('analytics') + '"]').prop('checked', true)
    $('input[name="marketing"][value="' + getCurrentCookieOption('marketing') + '"]').prop('checked', true)
    $('#save-cookie-settings').click(function () {
      saveCookieSettings()
      $('#cookie-settings-saved').removeClass('display-none')
      window.scrollTo(0, 0)
    })
  }
}

const displayCookieBanner = function ($) {
  if (!CookieMonster.get('cookies-analytics-option') && !CookieMonster.get('cookies-marketing-option')) {
    $('#global-cookie-message').removeClass('display-none')
    $('#global-cookie-message .accept-all').click(function () {
      CookieMonster.set('cookies-analytics-option', 'on', 365)
      CookieMonster.set('cookies-marketing-option', 'on', 365)
      activateAllTrackingScripts()
      $('#global-cookie-message').addClass('display-none')
    })
  }
}

const rejectCookies = function ($) {
  if (!CookieMonster.get('cookies-analytics-option') && !CookieMonster.get('cookies-marketing-option')) {
    $('#global-cookie-message').removeClass('display-none')
    $('#global-cookie-message .reject-all').click(function () {
      CookieMonster.set('cookies-analytics-option', 'off', 365)
      CookieMonster.set('cookies-marketing-option', 'off', 365)
      deactivateAnalyticsScripts()
      deactivateMarketingScripts()
      $('#global-cookie-message').addClass('display-none')
    })
  }
}

jQuery(function ($) {
  $(document).ready(function () {
    rejectCookies($)
    displayCookieBanner($)
    setupCookieSettingsForm($)
    activateApprovedTrackingScripts()
  })
})

},{"@firstandthird/cookie-monster":2}],2:[function(require,module,exports){
(function (exports) {
'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

function set(name, value) {
  var days = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
  var path = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '/';
  var domain = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
  var secure = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;

  var date = new Date();
  var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);

  var expires = '';
  var valueToUse = '';
  var secureFlag = '';
  var domainFlag = '';

  if (days) {
    date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
    expires = '; expires=' + date.toUTCString();
  }

  if (type === 'object' && type !== 'undefined') {
    valueToUse = encodeURIComponent(JSON.stringify({ value: value }));
  } else {
    valueToUse = encodeURIComponent(value);
  }

  if (secure) {
    secureFlag = '; secure';
  }

  if (domain) {
    domainFlag = '; domain=' + encodeURIComponent(domain);
  }

  document.cookie = name + '=' + valueToUse + expires + '; path=' + path + secureFlag + domainFlag;
}

function get(name) {
  var nameEQ = name + '=';
  var split = document.cookie.split(';');
  var value = null;

  split.forEach(function (item) {
    var cleaned = item.trim();

    if (cleaned.indexOf(nameEQ) === 0) {
      value = decodeURIComponent(cleaned.substring(nameEQ.length, cleaned.length));

      if (value.substring(0, 1) === '{') {
        try {
          value = JSON.parse(value);
          value = value.value || null;
        } catch (e) {
          return;
        }
      }

      if (value === 'undefined') {
        value = undefined;
      }
    }
  });

  return value;
}

function remove(name) {
  set(name, '', -1);
}

function increment(name, days) {
  var value = get(name) || 0;
  set(name, ~~value + 1, days);
}

function decrement(name, days) {
  var value = get(name) || 0;
  set(name, ~~value - 1, days);
}

var cookieMonster_default = {
  set: set,
  get: get,
  remove: remove,
  increment: increment,
  decrement: decrement
};

exports.set = set;
exports.get = get;
exports.remove = remove;
exports.increment = increment;
exports.decrement = decrement;
exports['default'] = cookieMonster_default;

}((this.FirstandthirdCookieMonster = this.FirstandthirdCookieMonster || {})));


},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvY29va2llLXNldHRpbmdzLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJzdGFuZHRoaXJkL2Nvb2tpZS1tb25zdGVyL2Rpc3QvY29va2llLW1vbnN0ZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyogZ2xvYmFscyBqUXVlcnksIGNvb2tpZU9wdGlvbnMsIGdvb2dsZUFuYWx5dGljcywgZ2xvYmFsR29vZ2xlQW5hbHl0aWNzLCBnYTRBbmFseXRpY3MsIGdvb2dsZUZsb29kbGlnaHQsIGZhY2Vib29rUGl4ZWwsIGxpbmtlZGluSW5zaWdodCwgZ29vZ2xlVGFnTWFuYWdlciwgZ2xvYmFsR29vZ2xlVGFnTWFuYWdlciAqL1xuJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IENvb2tpZU1vbnN0ZXIgPSByZXF1aXJlKCdAZmlyc3RhbmR0aGlyZC9jb29raWUtbW9uc3RlcicpLkZpcnN0YW5kdGhpcmRDb29raWVNb25zdGVyXG5cbmNvbnN0IHNhdmVDb29raWVTZXR0aW5ncyA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgYW5hbHl0aWNzT3B0aW9uID0galF1ZXJ5KCdpbnB1dFtuYW1lPVwiYW5hbHl0aWNzXCJdOmNoZWNrZWQnKS52YWwoKVxuICBjb25zdCBtYXJrZXRpbmdPcHRpb24gPSBqUXVlcnkoJ2lucHV0W25hbWU9XCJtYXJrZXRpbmdcIl06Y2hlY2tlZCcpLnZhbCgpXG4gIGlmIChhbmFseXRpY3NPcHRpb24gPT09ICdvZmYnKSB7XG4gICAgZGVhY3RpdmF0ZUFuYWx5dGljc1NjcmlwdHMoKVxuICB9XG4gIGlmIChtYXJrZXRpbmdPcHRpb24gPT09ICdvZmYnKSB7XG4gICAgZGVhY3RpdmF0ZU1hcmtldGluZ1NjcmlwdHMoKVxuICB9XG4gIENvb2tpZU1vbnN0ZXIuc2V0KCdjb29raWVzLWFuYWx5dGljcy1vcHRpb24nLCBhbmFseXRpY3NPcHRpb24sIDM2NSlcbiAgQ29va2llTW9uc3Rlci5zZXQoJ2Nvb2tpZXMtbWFya2V0aW5nLW9wdGlvbicsIG1hcmtldGluZ09wdGlvbiwgMzY1KVxufVxuXG5jb25zdCBnZXRDdXJyZW50Q29va2llT3B0aW9uID0gZnVuY3Rpb24gKGNvb2tpZVR5cGUpIHtcbiAgaWYgKENvb2tpZU1vbnN0ZXIuZ2V0KCdjb29raWVzLScgKyBjb29raWVUeXBlICsgJy1vcHRpb24nKSkge1xuICAgIHJldHVybiBDb29raWVNb25zdGVyLmdldCgnY29va2llcy0nICsgY29va2llVHlwZSArICctb3B0aW9uJylcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJ29mZidcbiAgfVxufVxuXG5jb25zdCBhY3RpdmF0ZUFuYWx5dGljc1NjcmlwdHMgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0eXBlb2YgZ29vZ2xlQW5hbHl0aWNzID09PSAnb2JqZWN0Jykge1xuICAgIGdvb2dsZUFuYWx5dGljcy5vbigpXG4gIH1cbiAgaWYgKHR5cGVvZiBnYTRBbmFseXRpY3MgPT09ICdvYmplY3QnKSB7XG4gICAgZ2E0QW5hbHl0aWNzLm9uKClcbiAgfVxuICBpZiAodHlwZW9mIGdsb2JhbEdvb2dsZUFuYWx5dGljcyA9PT0gJ29iamVjdCcpIHtcbiAgICBnbG9iYWxHb29nbGVBbmFseXRpY3Mub24oKVxuICB9XG4gIGlmICh0eXBlb2YgZ2xvYmFsR29vZ2xlVGFnTWFuYWdlciA9PT0gJ29iamVjdCcpIHtcbiAgICBnbG9iYWxHb29nbGVUYWdNYW5hZ2VyLm9uKClcbiAgfVxufVxuXG5jb25zdCBkZWFjdGl2YXRlQW5hbHl0aWNzU2NyaXB0cyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHR5cGVvZiBnb29nbGVBbmFseXRpY3MgPT09ICdvYmplY3QnKSB7XG4gICAgZ29vZ2xlQW5hbHl0aWNzLm9mZigpXG4gICAgZ29vZ2xlQW5hbHl0aWNzLmZpcnN0UGFydHlDb29raWVzLmZvckVhY2goZnVuY3Rpb24gKGNvb2tpZSkge1xuICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llICsgJz07IHBhdGg9LzsgZG9tYWluPScgKyBjb29raWVPcHRpb25zLmNvb2tpZURvbWFpbiArICc7IGV4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMSBHTVQ7J1xuICAgIH0pXG4gIH1cbiAgaWYgKHR5cGVvZiBnYTRBbmFseXRpY3MgPT09ICdvYmplY3QnKSB7XG4gICAgZ2E0QW5hbHl0aWNzLm9mZigpXG4gICAgZ2E0QW5hbHl0aWNzLmZpcnN0UGFydHlDb29raWVzLmZvckVhY2goZnVuY3Rpb24gKGNvb2tpZSkge1xuICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llICsgJz07IHBhdGg9LzsgZG9tYWluPScgKyBjb29raWVPcHRpb25zLmNvb2tpZURvbWFpbiArICc7IGV4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMSBHTVQ7J1xuICAgIH0pXG4gIH1cbiAgaWYgKHR5cGVvZiBnbG9iYWxHb29nbGVBbmFseXRpY3MgPT09ICdvYmplY3QnKSB7XG4gICAgZ2xvYmFsR29vZ2xlQW5hbHl0aWNzLm9mZigpXG4gICAgZ2xvYmFsR29vZ2xlQW5hbHl0aWNzLmZpcnN0UGFydHlDb29raWVzLmZvckVhY2goZnVuY3Rpb24gKGNvb2tpZSkge1xuICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llICsgJz07IHBhdGg9LzsgZG9tYWluPScgKyBjb29raWVPcHRpb25zLmNvb2tpZURvbWFpbiArICc7IGV4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMSBHTVQ7J1xuICAgIH0pXG4gIH1cbn1cblxuY29uc3QgYWN0aXZhdGVNYXJrZXRpbmdTY3JpcHRzID0gZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIGdvb2dsZUZsb29kbGlnaHQgPT09ICdvYmplY3QnKSB7XG4gICAgZ29vZ2xlRmxvb2RsaWdodC5vbigpXG4gIH1cbiAgaWYgKHR5cGVvZiBmYWNlYm9va1BpeGVsID09PSAnb2JqZWN0Jykge1xuICAgIGZhY2Vib29rUGl4ZWwub24oKVxuICB9XG4gIGlmICh0eXBlb2YgbGlua2VkaW5JbnNpZ2h0ID09PSAnb2JqZWN0Jykge1xuICAgIGxpbmtlZGluSW5zaWdodC5vbigpXG4gIH1cbiAgaWYgKHR5cGVvZiBnb29nbGVUYWdNYW5hZ2VyID09PSAnb2JqZWN0Jykge1xuICAgIGdvb2dsZVRhZ01hbmFnZXIub24oKVxuICB9XG59XG5cbmNvbnN0IGRlYWN0aXZhdGVNYXJrZXRpbmdTY3JpcHRzID0gZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIGdvb2dsZUZsb29kbGlnaHQgPT09ICdvYmplY3QnKSB7XG4gICAgZ29vZ2xlRmxvb2RsaWdodC5vZmYoKVxuICB9XG4gIGlmICh0eXBlb2YgZmFjZWJvb2tQaXhlbCA9PT0gJ29iamVjdCcpIHtcbiAgICBmYWNlYm9va1BpeGVsLm9mZigpXG4gICAgZmFjZWJvb2tQaXhlbC5maXJzdFBhcnR5Q29va2llcy5mb3JFYWNoKGZ1bmN0aW9uIChjb29raWUpIHtcbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZSArICc9OyBwYXRoPS87IGRvbWFpbj0nICsgY29va2llT3B0aW9ucy5jb29raWVEb21haW4gKyAnOyBleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDEgR01UOydcbiAgICB9KVxuICB9XG59XG5cbmNvbnN0IGFjdGl2YXRlQWxsVHJhY2tpbmdTY3JpcHRzID0gZnVuY3Rpb24gKCkge1xuICBhY3RpdmF0ZUFuYWx5dGljc1NjcmlwdHMoKVxuICBhY3RpdmF0ZU1hcmtldGluZ1NjcmlwdHMoKVxufVxuXG5jb25zdCBhY3RpdmF0ZUFwcHJvdmVkVHJhY2tpbmdTY3JpcHRzID0gZnVuY3Rpb24gKCkge1xuICBpZiAoY29va2llT3B0aW9ucy51c2VHb3Z1a0Nvb2tpZVNldHRpbmdzID09PSAnMScpIHtcbiAgICBpZiAoZ2V0Q3VycmVudENvb2tpZU9wdGlvbignYW5hbHl0aWNzJykgPT09ICdvbicpIHtcbiAgICAgIGFjdGl2YXRlQW5hbHl0aWNzU2NyaXB0cygpXG4gICAgfVxuICAgIGlmIChnZXRDdXJyZW50Q29va2llT3B0aW9uKCdtYXJrZXRpbmcnKSA9PT0gJ29uJykge1xuICAgICAgYWN0aXZhdGVNYXJrZXRpbmdTY3JpcHRzKClcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgYWN0aXZhdGVBbGxUcmFja2luZ1NjcmlwdHMoKVxuICB9XG59XG5cbmNvbnN0IHNldHVwQ29va2llU2V0dGluZ3NGb3JtID0gZnVuY3Rpb24gKCQpIHtcbiAgaWYgKCQoJyNjb29raWUtc2V0dGluZ3MtcGFuZWwnKS5sZW5ndGgpIHtcbiAgICAkKCcjY29va2llLXNldHRpbmdzLXBhbmVsJykucmVtb3ZlQ2xhc3MoJ2Rpc3BsYXktbm9uZScpXG4gICAgJCgnaW5wdXRbbmFtZT1cImFuYWx5dGljc1wiXVt2YWx1ZT1cIicgKyBnZXRDdXJyZW50Q29va2llT3B0aW9uKCdhbmFseXRpY3MnKSArICdcIl0nKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSlcbiAgICAkKCdpbnB1dFtuYW1lPVwibWFya2V0aW5nXCJdW3ZhbHVlPVwiJyArIGdldEN1cnJlbnRDb29raWVPcHRpb24oJ21hcmtldGluZycpICsgJ1wiXScpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKVxuICAgICQoJyNzYXZlLWNvb2tpZS1zZXR0aW5ncycpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIHNhdmVDb29raWVTZXR0aW5ncygpXG4gICAgICAkKCcjY29va2llLXNldHRpbmdzLXNhdmVkJykucmVtb3ZlQ2xhc3MoJ2Rpc3BsYXktbm9uZScpXG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMClcbiAgICB9KVxuICB9XG59XG5cbmNvbnN0IGRpc3BsYXlDb29raWVCYW5uZXIgPSBmdW5jdGlvbiAoJCkge1xuICBpZiAoIUNvb2tpZU1vbnN0ZXIuZ2V0KCdjb29raWVzLWFuYWx5dGljcy1vcHRpb24nKSAmJiAhQ29va2llTW9uc3Rlci5nZXQoJ2Nvb2tpZXMtbWFya2V0aW5nLW9wdGlvbicpKSB7XG4gICAgJCgnI2dsb2JhbC1jb29raWUtbWVzc2FnZScpLnJlbW92ZUNsYXNzKCdkaXNwbGF5LW5vbmUnKVxuICAgICQoJyNnbG9iYWwtY29va2llLW1lc3NhZ2UgLmFjY2VwdC1hbGwnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICBDb29raWVNb25zdGVyLnNldCgnY29va2llcy1hbmFseXRpY3Mtb3B0aW9uJywgJ29uJywgMzY1KVxuICAgICAgQ29va2llTW9uc3Rlci5zZXQoJ2Nvb2tpZXMtbWFya2V0aW5nLW9wdGlvbicsICdvbicsIDM2NSlcbiAgICAgIGFjdGl2YXRlQWxsVHJhY2tpbmdTY3JpcHRzKClcbiAgICAgICQoJyNnbG9iYWwtY29va2llLW1lc3NhZ2UnKS5hZGRDbGFzcygnZGlzcGxheS1ub25lJylcbiAgICB9KVxuICB9XG59XG5cbmNvbnN0IHJlamVjdENvb2tpZXMgPSBmdW5jdGlvbiAoJCkge1xuICBpZiAoIUNvb2tpZU1vbnN0ZXIuZ2V0KCdjb29raWVzLWFuYWx5dGljcy1vcHRpb24nKSAmJiAhQ29va2llTW9uc3Rlci5nZXQoJ2Nvb2tpZXMtbWFya2V0aW5nLW9wdGlvbicpKSB7XG4gICAgJCgnI2dsb2JhbC1jb29raWUtbWVzc2FnZScpLnJlbW92ZUNsYXNzKCdkaXNwbGF5LW5vbmUnKVxuICAgICQoJyNnbG9iYWwtY29va2llLW1lc3NhZ2UgLnJlamVjdC1hbGwnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICBDb29raWVNb25zdGVyLnNldCgnY29va2llcy1hbmFseXRpY3Mtb3B0aW9uJywgJ29mZicsIDM2NSlcbiAgICAgIENvb2tpZU1vbnN0ZXIuc2V0KCdjb29raWVzLW1hcmtldGluZy1vcHRpb24nLCAnb2ZmJywgMzY1KVxuICAgICAgZGVhY3RpdmF0ZUFuYWx5dGljc1NjcmlwdHMoKVxuICAgICAgZGVhY3RpdmF0ZU1hcmtldGluZ1NjcmlwdHMoKVxuICAgICAgJCgnI2dsb2JhbC1jb29raWUtbWVzc2FnZScpLmFkZENsYXNzKCdkaXNwbGF5LW5vbmUnKVxuICAgIH0pXG4gIH1cbn1cblxualF1ZXJ5KGZ1bmN0aW9uICgkKSB7XG4gICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICByZWplY3RDb29raWVzKCQpXG4gICAgZGlzcGxheUNvb2tpZUJhbm5lcigkKVxuICAgIHNldHVwQ29va2llU2V0dGluZ3NGb3JtKCQpXG4gICAgYWN0aXZhdGVBcHByb3ZlZFRyYWNraW5nU2NyaXB0cygpXG4gIH0pXG59KVxuIiwiKGZ1bmN0aW9uIChleHBvcnRzKSB7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxuZnVuY3Rpb24gc2V0KG5hbWUsIHZhbHVlKSB7XG4gIHZhciBkYXlzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsO1xuICB2YXIgcGF0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogJy8nO1xuICB2YXIgZG9tYWluID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBudWxsO1xuICB2YXIgc2VjdXJlID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgJiYgYXJndW1lbnRzWzVdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNV0gOiBmYWxzZTtcblxuICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSk7XG5cbiAgdmFyIGV4cGlyZXMgPSAnJztcbiAgdmFyIHZhbHVlVG9Vc2UgPSAnJztcbiAgdmFyIHNlY3VyZUZsYWcgPSAnJztcbiAgdmFyIGRvbWFpbkZsYWcgPSAnJztcblxuICBpZiAoZGF5cykge1xuICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIGRheXMgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICBleHBpcmVzID0gJzsgZXhwaXJlcz0nICsgZGF0ZS50b1VUQ1N0cmluZygpO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdvYmplY3QnICYmIHR5cGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdmFsdWVUb1VzZSA9IGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh7IHZhbHVlOiB2YWx1ZSB9KSk7XG4gIH0gZWxzZSB7XG4gICAgdmFsdWVUb1VzZSA9IGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG4gIH1cblxuICBpZiAoc2VjdXJlKSB7XG4gICAgc2VjdXJlRmxhZyA9ICc7IHNlY3VyZSc7XG4gIH1cblxuICBpZiAoZG9tYWluKSB7XG4gICAgZG9tYWluRmxhZyA9ICc7IGRvbWFpbj0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvbWFpbik7XG4gIH1cblxuICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz0nICsgdmFsdWVUb1VzZSArIGV4cGlyZXMgKyAnOyBwYXRoPScgKyBwYXRoICsgc2VjdXJlRmxhZyArIGRvbWFpbkZsYWc7XG59XG5cbmZ1bmN0aW9uIGdldChuYW1lKSB7XG4gIHZhciBuYW1lRVEgPSBuYW1lICsgJz0nO1xuICB2YXIgc3BsaXQgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcbiAgdmFyIHZhbHVlID0gbnVsbDtcblxuICBzcGxpdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGNsZWFuZWQgPSBpdGVtLnRyaW0oKTtcblxuICAgIGlmIChjbGVhbmVkLmluZGV4T2YobmFtZUVRKSA9PT0gMCkge1xuICAgICAgdmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoY2xlYW5lZC5zdWJzdHJpbmcobmFtZUVRLmxlbmd0aCwgY2xlYW5lZC5sZW5ndGgpKTtcblxuICAgICAgaWYgKHZhbHVlLnN1YnN0cmluZygwLCAxKSA9PT0gJ3snKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnZhbHVlIHx8IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHZhbHVlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB2YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlKG5hbWUpIHtcbiAgc2V0KG5hbWUsICcnLCAtMSk7XG59XG5cbmZ1bmN0aW9uIGluY3JlbWVudChuYW1lLCBkYXlzKSB7XG4gIHZhciB2YWx1ZSA9IGdldChuYW1lKSB8fCAwO1xuICBzZXQobmFtZSwgfn52YWx1ZSArIDEsIGRheXMpO1xufVxuXG5mdW5jdGlvbiBkZWNyZW1lbnQobmFtZSwgZGF5cykge1xuICB2YXIgdmFsdWUgPSBnZXQobmFtZSkgfHwgMDtcbiAgc2V0KG5hbWUsIH5+dmFsdWUgLSAxLCBkYXlzKTtcbn1cblxudmFyIGNvb2tpZU1vbnN0ZXJfZGVmYXVsdCA9IHtcbiAgc2V0OiBzZXQsXG4gIGdldDogZ2V0LFxuICByZW1vdmU6IHJlbW92ZSxcbiAgaW5jcmVtZW50OiBpbmNyZW1lbnQsXG4gIGRlY3JlbWVudDogZGVjcmVtZW50XG59O1xuXG5leHBvcnRzLnNldCA9IHNldDtcbmV4cG9ydHMuZ2V0ID0gZ2V0O1xuZXhwb3J0cy5yZW1vdmUgPSByZW1vdmU7XG5leHBvcnRzLmluY3JlbWVudCA9IGluY3JlbWVudDtcbmV4cG9ydHMuZGVjcmVtZW50ID0gZGVjcmVtZW50O1xuZXhwb3J0c1snZGVmYXVsdCddID0gY29va2llTW9uc3Rlcl9kZWZhdWx0O1xuXG59KCh0aGlzLkZpcnN0YW5kdGhpcmRDb29raWVNb25zdGVyID0gdGhpcy5GaXJzdGFuZHRoaXJkQ29va2llTW9uc3RlciB8fCB7fSkpKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29va2llLW1vbnN0ZXIuanMubWFwIl19
